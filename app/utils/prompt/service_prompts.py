# 관심사 추출 프롬프트
EXTRACT_KEYWORDS_SYSTEM_PROMPT = (
    "아래 메시지 리스트를 참고해서 사용자의 관심 키워드를 추출하고, "
    "각 키워드가 어떤 message_id에서 추출됐는지와 중요도(importance, 0~1 float)를 반드시 JSON 배열 형태로 반환하세요. "
    "출력 예시: [{\"keyword\": \"국내여행\", \"importance\": 0.92, \"message_ids\": [\"c7da6b58-3700-469d-9fd7-0b0f5b78571b\", \"55460f94-f1c2-423b-a3e3-4f9011f4633c\"]}]"
    "\n각 message_ids는 문자열 리스트로, 키워드별로 연관된 message_id만 포함해야 합니다. "
    "importance는 해당 키워드가 사용자 관심사에서 차지하는 의미/비중을 0~1 사이 실수로 평가해 주세요. "
    "특히, 새로 추출된 키워드가 기존 키워드 리스트와 비슷할수록 importance를 높게 평가하세요. "
    "불필요한 설명 없이 JSON 데이터만 출력하세요."
)


def get_interest_user_prompt(message_list, user_keywords=None):
    """
    message_list: [{'id': '...', 'content': '...'}, ...]
    user_keywords: ["키워드1", "키워드2", ...] (optional)
    """
    joined = "\n".join(
        f"- id: {m['id']}, content: {m['content']}" for m in message_list)
    prompt = (
        "아래 메시지 리스트를 참고해서 사용자의 관심 키워드와, 각 키워드가 어떤 message_id에서 추출됐는지, 그리고 중요도(importance, 0~1 float)를 JSON 형태로 반환해줘.\n"
        "중요도는 해당 키워드가 사용자 관심사에서 차지하는 의미/비중을 0~1 사이 실수로 평가해줘.\n"
    )
    if user_keywords:
        prompt += (
            f"\n참고: 사용자의 기존 관심 키워드 리스트는 다음과 같아. 새로 추출된 키워드가 이 리스트와 비슷할수록 중요도를 높게 평가해줘.\n기존 키워드: {', '.join(user_keywords)}\n"
        )
    prompt += "메시지 리스트:\n" + joined
    return prompt


# 세션 요약 프롬프트
SESSION_SUMMARY_SYSTEM_PROMPT = (
    "다음 대화 전체를 바탕으로 세션의 제목과 설명을 생성해주세요. 제목은 20자 이내, 설명은 100자 이내로 작성하고, 응답은 JSON 형식으로 'title'과 'description' 키를 포함해야 합니다."
)

SESSION_SUMMARY_USER_PROMPT = ("다음 대화를 바탕으로 세션의 제목과 설명을 생성해주세요: \n\n")

INSIGHT_ARTICLE_SYSTEM_PROMPT = (
    "다음 대화 내용을 바탕으로 사용자의 관심사에 맞는 인사이트 아티클을 작성해주세요. "
    "아티클은 사용자의 상위 3개 관심사를 반영하고, 제목과 내용을 포함해야 합니다. "
    "제목은 50자 이내로 작성하고, 내용은 500자 이상이어야 합니다. "
    "응답은 JSON 형식으로 'title'과 'content' 키를 포함해야 합니다."
)

USER_MEMORY_SYSTEM_PROMPT = (
    "당신은 사용자의 장기기억을 생성 및 관리하는 AI입니다.\n\n"
    "아래 세 가지 정보를 참고하여, 사용자의 장기기억(주요 관심사·선호·취향 등)을 업데이트하세요:\n"
    "- [기존 장기기억]: 현재까지 저장된 항목별 정보\n"
    "- [최근 대화 요약]: 최근 대화의 핵심 내용\n"
    "- [최근 메시지]: 사용자의 가장 최근 발화\n\n"
    "이 세 정보를 종합해 **사용자의 장기기억(사용자의 주요 관심사, 선호도, 취향)을 업데이트** 해주세요.\n\n"
    "업데이트 기준은 다음과 같습니다:\n"
    "1. 정보를 **카테고리별(예: [지역], [업무], [취미], [목표], [루틴], [학습], [건강], [관계], [관심사/기술], [소비/쇼핑]) 등으로 분류**하여 각 항목을 1~2문장 이내로 핵심 요약하세요.\n"
    "2. 중복·비슷한 내용은 **최신 정보로 대체**하거나 하나로 합쳐 정리하세요.\n"
    "3. 불필요하거나 일회성, 잡담 등은 포함하지 않습니다 (예: 감탄사, 잡담, 일회성 요청 등).\n"
    "4. 기존 항목과 겹치는 경우 **더 구체적·최신 내용**으로 갱신하세요.\n"
    "5. 정보 간 맥락을 고려하여 정리하고, 핵심 사실만 명확하게 정제하세요.\n"
    "6. 전체 항목은 **최대 10개 이내**로 압축해, 가장 중요한 정보만 남기세요.\n"
    "7. **이번에 새롭게 추가되었거나 업데이트된 카테고리는 목록의 가장 앞쪽(위쪽)에 위치**시키고, 이전부터 유지된 항목은 그 뒤에 정렬하세요.\n"
    "8. 출력 형식: 각 항목을 `[카테고리] 요약 내용` 형식으로 줄바꿈하여 작성하세요.\n\n"
    "예시:\n"
    "- [지역] 현재 서울 강남구에 거주, 주말에는 주로 대전 방문.\n"
    "- [여행] 최근 일본 여행 계획 중, 교통·음식·관광지 정보 탐색.\n"
    "- [업무] 매주 월요일 오전 9시 팀 미팅, 프로젝트 마감일 관리.\n"
    "- [취미] 등산과 사진 촬영 즐김, 새로운 산행 코스 탐색 선호.\n"
    "- [건강] 규칙적 운동과 식단 관리에 신경 씀.\n"
    "- [관계] 가족, 친구와의 만남 및 소통 중요하게 생각.\n"
    "- [학습] 영어 회화 실력 향상 목표로 매일 학습.\n"
    "- [목표] 올해 마라톤 완주, 자격증 취득 계획.\n"
    "- [루틴] 아침 운동과 밤 독서 루틴 실천 중.\n"
    "- [관심사/기술] 최신 IT 트렌드 및 신기술에 관심 많음.\n"
)

